---
const { pathname } = Astro.url;

import { getSiteUrl } from '../utils/getSiteUrl.js';

const siteUrl = getSiteUrl(pathname)

const parts = pathname.split('/').filter(Boolean);

const itUrl = '/' + ['it', 'it', ...parts.slice(2)].join('/');
const ukUrl = '/' + ['uk', 'en', ...parts.slice(2)].join('/');
const deUrl = '/' + ['de', 'de', ...parts.slice(2)].join('/');

import { getTranslations } from '../lib/translationService.js';
const language = Astro.params.language || 'en';
const translations = await getTranslations();
const pageTranslations = translations[language] || {};

---

<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
	</head>
	<body data-site-language={language}>
		
		<div id="navigation">
			<a href={`${siteUrl}/`}>Home</a>
			<a href={`${siteUrl}/products`}>Products</a>
		</div>
		<div id="language-switcher">
			<a href={ukUrl}>ğŸ‡¬ğŸ‡§ UK</a>
			<a href={itUrl}>ğŸ‡®ğŸ‡¹ IT</a>
			<a href={deUrl}>ğŸ‡©ğŸ‡ª DE</a>
		  </div>
		<slot />

		<script is:inline define:vars={{ pageTranslations }}>
			window.translationsJSON = pageTranslations;
		  </script>
		  
	</body>
</html>
